{"ast":null,"code":"// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html\nvar jsts = require('jsts');\n/**\n * Finds the difference between two {@link Polygon|polygons} by clipping the second\n * polygon from the first.\n *\n * @name difference\n * @param {Feature<Polygon>} poly1 input Polygon feaure\n * @param {Feature<Polygon>} poly2 Polygon feature to difference from `poly1`\n * @return {Feature<Polygon>} a Polygon feature showing the area of `poly1` excluding the area of `poly2`\n * @example\n * var poly1 = {\n *   \"type\": \"Feature\",\n *   \"properties\": {\n *     \"fill\": \"#0f0\"\n *   },\n *   \"geometry\": {\n *     \"type\": \"Polygon\",\n *     \"coordinates\": [[\n *       [-46.738586, -23.596711],\n *       [-46.738586, -23.458207],\n *       [-46.560058, -23.458207],\n *       [-46.560058, -23.596711],\n *       [-46.738586, -23.596711]\n *     ]]\n *   }\n * };\n * var poly2 = {\n *   \"type\": \"Feature\",\n *   \"properties\": {\n *     \"fill\": \"#00f\"\n *   },\n *   \"geometry\": {\n *     \"type\": \"Polygon\",\n *     \"coordinates\": [[\n *       [-46.650009, -23.631314],\n *       [-46.650009, -23.5237],\n *       [-46.509246, -23.5237],\n *       [-46.509246, -23.631314],\n *       [-46.650009, -23.631314]\n *     ]]\n *   }\n * };\n *\n * var differenced = turf.difference(poly1, poly2);\n * differenced.properties.fill = '#f00';\n *\n * var polygons = {\n *   \"type\": \"FeatureCollection\",\n *   \"features\": [poly1, poly2]\n * };\n *\n * //=polygons\n *\n * //=differenced\n */\n\n\nmodule.exports = function (p1, p2) {\n  var poly1 = JSON.parse(JSON.stringify(p1));\n  var poly2 = JSON.parse(JSON.stringify(p2));\n\n  if (poly1.type !== 'Feature') {\n    poly1 = {\n      type: 'Feature',\n      properties: {},\n      geometry: poly1\n    };\n  }\n\n  if (poly2.type !== 'Feature') {\n    poly2 = {\n      type: 'Feature',\n      properties: {},\n      geometry: poly2\n    };\n  }\n\n  var reader = new jsts.io.GeoJSONReader();\n  var a = reader.read(JSON.stringify(poly1.geometry));\n  var b = reader.read(JSON.stringify(poly2.geometry));\n  var differenced = a.difference(b);\n  if (differenced.isEmpty()) return undefined;\n  var writer = new jsts.io.GeoJSONWriter();\n  var geojsonGeometry = writer.write(differenced);\n  poly1.geometry = differenced;\n  return {\n    type: 'Feature',\n    properties: poly1.properties,\n    geometry: geojsonGeometry\n  };\n};","map":{"version":3,"sources":["/Users/yiqianyao/workspace/something/floorcanvas/node_modules/turf-difference/index.js"],"names":["jsts","require","module","exports","p1","p2","poly1","JSON","parse","stringify","poly2","type","properties","geometry","reader","io","GeoJSONReader","a","read","b","differenced","difference","isEmpty","undefined","writer","GeoJSONWriter","geojsonGeometry","write"],"mappings":"AAAA;AACA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAAUC,EAAV,EAAcC,EAAd,EAAkB;AAC/B,MAAIC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,EAAf,CAAX,CAAZ;AACA,MAAIM,KAAK,GAAGH,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeJ,EAAf,CAAX,CAAZ;;AACA,MAAIC,KAAK,CAACK,IAAN,KAAe,SAAnB,EAA8B;AAC1BL,IAAAA,KAAK,GAAG;AACJK,MAAAA,IAAI,EAAE,SADF;AAEJC,MAAAA,UAAU,EAAE,EAFR;AAGJC,MAAAA,QAAQ,EAAEP;AAHN,KAAR;AAKH;;AACD,MAAII,KAAK,CAACC,IAAN,KAAe,SAAnB,EAA8B;AAC1BD,IAAAA,KAAK,GAAG;AACJC,MAAAA,IAAI,EAAE,SADF;AAEJC,MAAAA,UAAU,EAAE,EAFR;AAGJC,MAAAA,QAAQ,EAAEH;AAHN,KAAR;AAKH;;AAED,MAAII,MAAM,GAAG,IAAId,IAAI,CAACe,EAAL,CAAQC,aAAZ,EAAb;AACA,MAAIC,CAAC,GAAGH,MAAM,CAACI,IAAP,CAAYX,IAAI,CAACE,SAAL,CAAeH,KAAK,CAACO,QAArB,CAAZ,CAAR;AACA,MAAIM,CAAC,GAAGL,MAAM,CAACI,IAAP,CAAYX,IAAI,CAACE,SAAL,CAAeC,KAAK,CAACG,QAArB,CAAZ,CAAR;AACA,MAAIO,WAAW,GAAGH,CAAC,CAACI,UAAF,CAAaF,CAAb,CAAlB;AAEA,MAAIC,WAAW,CAACE,OAAZ,EAAJ,EAA2B,OAAOC,SAAP;AAE3B,MAAIC,MAAM,GAAG,IAAIxB,IAAI,CAACe,EAAL,CAAQU,aAAZ,EAAb;AACA,MAAIC,eAAe,GAAGF,MAAM,CAACG,KAAP,CAAaP,WAAb,CAAtB;AAEAd,EAAAA,KAAK,CAACO,QAAN,GAAiBO,WAAjB;AAEA,SAAO;AACHT,IAAAA,IAAI,EAAE,SADH;AAEHC,IAAAA,UAAU,EAAEN,KAAK,CAACM,UAFf;AAGHC,IAAAA,QAAQ,EAAEa;AAHP,GAAP;AAKH,CAnCD","sourcesContent":["// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html\nvar jsts = require('jsts');\n\n/**\n * Finds the difference between two {@link Polygon|polygons} by clipping the second\n * polygon from the first.\n *\n * @name difference\n * @param {Feature<Polygon>} poly1 input Polygon feaure\n * @param {Feature<Polygon>} poly2 Polygon feature to difference from `poly1`\n * @return {Feature<Polygon>} a Polygon feature showing the area of `poly1` excluding the area of `poly2`\n * @example\n * var poly1 = {\n *   \"type\": \"Feature\",\n *   \"properties\": {\n *     \"fill\": \"#0f0\"\n *   },\n *   \"geometry\": {\n *     \"type\": \"Polygon\",\n *     \"coordinates\": [[\n *       [-46.738586, -23.596711],\n *       [-46.738586, -23.458207],\n *       [-46.560058, -23.458207],\n *       [-46.560058, -23.596711],\n *       [-46.738586, -23.596711]\n *     ]]\n *   }\n * };\n * var poly2 = {\n *   \"type\": \"Feature\",\n *   \"properties\": {\n *     \"fill\": \"#00f\"\n *   },\n *   \"geometry\": {\n *     \"type\": \"Polygon\",\n *     \"coordinates\": [[\n *       [-46.650009, -23.631314],\n *       [-46.650009, -23.5237],\n *       [-46.509246, -23.5237],\n *       [-46.509246, -23.631314],\n *       [-46.650009, -23.631314]\n *     ]]\n *   }\n * };\n *\n * var differenced = turf.difference(poly1, poly2);\n * differenced.properties.fill = '#f00';\n *\n * var polygons = {\n *   \"type\": \"FeatureCollection\",\n *   \"features\": [poly1, poly2]\n * };\n *\n * //=polygons\n *\n * //=differenced\n */\n\nmodule.exports = function (p1, p2) {\n    var poly1 = JSON.parse(JSON.stringify(p1));\n    var poly2 = JSON.parse(JSON.stringify(p2));\n    if (poly1.type !== 'Feature') {\n        poly1 = {\n            type: 'Feature',\n            properties: {},\n            geometry: poly1\n        };\n    }\n    if (poly2.type !== 'Feature') {\n        poly2 = {\n            type: 'Feature',\n            properties: {},\n            geometry: poly2\n        };\n    }\n\n    var reader = new jsts.io.GeoJSONReader();\n    var a = reader.read(JSON.stringify(poly1.geometry));\n    var b = reader.read(JSON.stringify(poly2.geometry));\n    var differenced = a.difference(b);\n\n    if (differenced.isEmpty()) return undefined;\n\n    var writer = new jsts.io.GeoJSONWriter();\n    var geojsonGeometry = writer.write(differenced);\n\n    poly1.geometry = differenced;\n\n    return {\n        type: 'Feature',\n        properties: poly1.properties,\n        geometry: geojsonGeometry\n    };\n};\n"]},"metadata":{},"sourceType":"script"}